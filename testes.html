<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cardápio Digital</title>
    <style>
        body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f0f0f0; /* Cinza claro para fundo geral */
    color: #333; /* Texto principal cinza escuro */
}

header {
    background-color: #FFA500; /* Laranja mais suave */
    color: white;
    text-align: center;
    padding: 30px;
    position: relative;
}

.logo {
    width: 150px; /* Define a largura fixa */
    height: 150px; /* Define a altura fixa para garantir que seja quadrada */
    border-radius: 50%; /* Torna a imagem redonda */
    object-fit: cover; /* Garante que a imagem preencha o círculo sem distorção */
    display: block; /* Alinha a imagem como bloco */
    margin: 20px auto 0; /* Espaçamento de 20px na parte superior */
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Adiciona uma leve sombra para destaque */
}

.category-menu {
    display: flex;
    overflow-x: auto; /* Permite rolagem horizontal */
    white-space: nowrap; /* Evita quebras de linha entre os itens */
    background-color: #222; /* Fundo preto profundo */
    border-bottom: 2px solid #FFA500; /* Borda laranja */
    padding: 15px 0; /* Espaçamento interno vertical */
    position: sticky;
    top: 0;
}

.category-menu::-webkit-scrollbar {
    display: none; /* Oculta a barra de rolagem no Chrome, Safari e Edge */
}

.category-menu div {
    text-decoration: none;
    color: #FFA500; /* Laranja para o texto */
    font-weight: bold;
    cursor: pointer;
    padding: 10px 20px;
    flex-shrink: 0; /* Garante que os itens não encolham */
    transition: background-color 0.3s ease, color 0.3s ease;
    border-left: 1px solid #FFA500; /* Borda entre itens */
}

.category-menu div:first-child {
    border-left: none; /* Remove a borda do primeiro item */
}

.category-menu div:hover {
    background-color: #FFA500;
    color: #222;
    border-radius: 5px;
}

.category-menu a {
    text-decoration: none;
    color: #FFA500; /* Laranja suave para o texto */
    font-weight: bold;
    cursor: pointer;
}

.category-content {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #f5f5f5; /* Fundo cinza bem claro */
    z-index: 1000;
    padding: 20px;
    overflow-y: auto;
    opacity: 0; /* Começa invisível */
    transform: translateY(20px); /* Começa um pouco deslocado para baixo */
    transition: opacity 0.5s ease, transform 0.5s ease; /* Transições suaves */
    pointer-events: none; /* Desabilita a interação enquanto invisível */
}

.category-content.active {
    opacity: 1; /* Torna visível */
    transform: translateY(0); /* Volta para a posição original */
    pointer-events: auto; /* Habilita a interação */
}

.category-content h2 {
    margin-top: 0;
    color: #FFA500; /* Título em laranja suave */
}

.category-content .back-btn {
    background-color: #FFA500; /* Botão laranja suave */
    color: white;
    border: none;
    padding: 10px 20px;
    cursor: pointer;
    border-radius: 5px;
    font-size: 16px;
    margin-bottom: 20px;
}

.product-list {
    margin-bottom: 20px; /* Espaçamento padrão entre os itens */
    padding: 20px; /* Espaçamento interno */
}

.product-list:last-child {
    margin-bottom: 100px; /* Maior espaçamento para o último item */
}

.product {
    background-color: white;
    padding: 10px;
    margin-bottom: 10px;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); /* Sombra leve */
}

.product-title {
    font-size: 18px;
    margin-bottom: 5px;
    color: #222; /* Título laranja suave */
}

.price {
    color: green; /* Um tom mais forte de laranja/verde para preços */
    margin-bottom: 10px;
}

.note {
    background-color: #ff4500; /* Fundo laranja suave */
    color: white;
    padding: 5px;
    text-align: center;
    border-radius: 5px;
}

.cart-toggle {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background-color: #222; /* Preto para contraste no botão */
    color: #FFA500; /* Texto laranja suave */
    text-align: center;
    padding: 10px;
    cursor: pointer;
    font-size: 16px;
    border-top: 2px solid orange;
    z-index: 2000;
}

.notification-bubble {
    position: absolute;
    top: 8px;
    right: 15px;
    background-color: #ff4500; /* Vermelho/laranja para destaque */
    color: white;
    border-radius: 50%;
    padding: 5px 10px;
    font-size: 12px;
    font-weight: bold;
    display: none; /* Inicialmente oculto */
}

.cart.open .notification-bubble {
    display: block; /* Exibe o balão quando o carrinho estiver aberto */
}

.cart {
    position: fixed;
    bottom: -100%;
    left: 0;
    right: 0;
    background-color: #222;
    border-top: 2px solid #FFA500; /* Borda laranja */
    box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
    padding: 10px;
    max-height: 300px;
    overflow-y: auto;
    color: white;
}

.cart.open {
    bottom: 50px;
    z-index: 2000;
}

.cart h2 {
    text-align: center;
    margin: 0;
    padding-bottom: 10px;
    border-bottom: 1px solid #FFA500;
}

.cart-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.close-cart {
    background-color: transparent;
    border: none;
    font-size: 20px;
    cursor: pointer;
    color: red; /* Laranja suave */
}

.cart-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.remove-btn {
    background-color: #ff4500; /* Vermelho/laranja para o botão de remover */
    color: white;
    border: none;
    padding: 5px 10px;
    cursor: pointer;
    border-radius: 5px;
}

.cart-total {
    display: flex;
    justify-content: space-between;
    padding: 10px 0;
}

#finalize-order {
    background-color: #FFA500; /* Botão laranja suave */
    color: white;
    border: none;
    padding: 10px 20px;
    cursor: pointer;
    border-radius: 5px;
    width: 100%;
}

.checkout {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background-color: #1e1e1e; /* Fundo preto suave */
    border-top: 4px solid #FFA500; /* Borda laranja vibrante */
    box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.3); /* Sombra mais forte */
    padding: 20px;
    z-index: 2000;
    color: white;
    border-radius: 15px 15px 0 0; /* Bordas arredondadas */
    opacity: 0; /* Invisível inicialmente */
    transform: translateY(100%); /* Deslocado para fora da tela inicialmente */
    transition: opacity 0.5s ease, transform 0.5s ease; /* Transição suave */
    pointer-events: none; /* Desabilita a interação enquanto invisível */
}

.checkout.open {
    opacity: 1; /* Visível */
    transform: translateY(0); /* Posição original */
    pointer-events: auto; /* Habilita interação */
}

.checkout-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 2px solid #FFA500; /* Borda na parte superior */
    padding-bottom: 15px;
    margin-bottom: 15px;
}

.checkout-header h2 {
    color: #FFA500; /* Cor laranja para o título */
    font-size: 24px;
}

.form-field {
    margin-bottom: 15px;
}

.form-field label {
    display: block;
    margin-bottom: 5px;
    font-size: 16px;
    color: #fff;
}

.form-field input, .form-field select {
    width: 100%;
    padding: 10px;
    border: 1px solid #333; /* Borda mais discreta */
    border-radius: 10px;
    background-color: #2e2e2e; /* Fundo escuro */
    color: #fff;
    font-size: 16px;
    outline: none;
    transition: border 0.3s ease; /* Transição para foco */
}

.form-field input:focus, .form-field select:focus {
    border: 1px solid #FFA500; /* Destaque no foco */
}

.total-display {
    position: absolute;
    top: 20px;
    right: 20px;
    font-size: 20px;
    font-weight: bold;
    color: #FFA500;
}

#change-field {
    display: none;
}

#submit-order {
    width: 100%;
    padding: 15px;
    background-color: #FFA500; /* Cor laranja vibrante */
    color: white; /* Texto branco */
    border: none;
    border-radius: 12px; /* Bordas arredondadas */
    font-size: 18px; /* Tamanho da fonte */
    font-weight: bold; /* Texto em negrito */
    cursor: pointer;
    transition: all 0.3s ease; /* Transição suave */
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Sombra para dar profundidade */
}

#submit-order:hover {
    background-color: #ff8c00; /* Cor mais escura ao passar o mouse */
    box-shadow: 0 6px 8px rgba(0, 0, 0, 0.2); /* Sombra mais intensa no hover */
}

#submit-order:active {
    background-color: #e67600; /* Cor ainda mais escura ao clicar */
    box-shadow: 0 3px 5px rgba(0, 0, 0, 0.15); /* Sombra mais leve no clique */
    transform: translateY(2px); /* Efeito de clique que simula um pressionar */
}

#submit-order:focus {
    outline: none;
    box-shadow: 0 0 5px #FFA500; /* Destaque ao focar com o teclado */
}

.back-btn {
    background-color: #FFA500; /* Cor laranja vibrante */
    color: white; /* Texto branco */
    border: none;
    border-radius: 50%; /* Forma circular */
    width: 50px;
    height: 50px; /* Tamanho para criar o botão circular */
    font-size: 24px; /* Tamanho da seta */
    font-weight: bold; /* Seta mais destacada */
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: all 0.3s ease; /* Transição suave */
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Sombra para profundidade */
}

.back-btn:hover {
    background-color: #ff8c00; /* Cor mais escura ao passar o mouse */
    box-shadow: 0 6px 8px rgba(0, 0, 0, 0.2); /* Sombra mais intensa */
}

.back-btn:active {
    background-color: #e67600; /* Cor ainda mais escura ao clicar */
    box-shadow: 0 3px 5px rgba(0, 0, 0, 0.15); /* Sombra reduzida ao clicar */
    transform: translateY(2px); /* Efeito de "pressionar" */
}

.back-btn:focus {
    outline: none;
    box-shadow: 0 0 5px #FFA500; /* Destaque ao focar com o teclado */
}

.add-btn {
    background-color: #28a745; /* Cor verde */
    color: white; /* Texto branco */
    border: none;
    padding: 9px;
    cursor: pointer;
    border-radius: 5px; /* Bordas arredondadas */
    font-size: 7px;
    transition: all 0.3s ease; /* Transição suave */
    transform: translateY(-2px); /* Mover 10px para cima */
}

.add-btn:hover {
    background-color: #218838; /* Verde mais escuro ao passar o mouse */
}

.add-btn:active {
    background-color: #1e7e34; /* Verde ainda mais escuro ao clicar */
    transform: translateY(2px); /* Efeito de clique */
}

.add-btn:focus {
    outline: none;
    box-shadow: 0 0 5px #28a745; /* Sombra verde ao focar */
}

.operating-hours {
    background-color: #1e1e1e;
    color: white;
    padding: 4px;
    font-size: 12px;
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    margin: 0 auto;
    text-align: center;
    display: flex;
    justify-content: center;
    align-items: center;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    z-index: 999;
    max-width: 100%; /* Garante que não ultrapasse a largura da tela */
}

.operating-hours span {
    margin-left: 10px;
}

.status {
    font-weight: bold;
    color: white;
    padding: 5px 10px;
    border-radius: 20px;
    left: 50%;
    font-size: 13px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    text-transform: uppercase;
}

.status.open {
    background-color: #28a745; /* Verde suave para aberto */
}

.status.closed {
    background-color: #dc3545; /* Vermelho suave para fechado */
}

#open-maps {
    width: 100%;
    padding: 15px;
    background-color: #FFA500; /* Cor laranja vibrante */
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

#open-maps:hover {
    background-color: #ff8c00;
}

#open-maps:active {
    background-color: #e67600;
    box-shadow: 0 3px 5px rgba(0, 0, 0, 0.15);
    transform: translateY(2px);
}


.inline-options {
    display: flex;
    align-items: center;
    gap: 100px; /* Reduza este valor se necessário */
    margin-right: 20%;
}

.inline-options label {
    margin-left: -45%; /* Ajusta para aproximar mais o texto ao botão */
}

.tutorial-balao {
  position: absolute;
  background: linear-gradient(135deg, #444, #222); /* Gradiente para um visual suave */
  color: #fff;
  padding: 15px;
  border-radius: 8px;
  max-width: 220px;
  box-shadow: 0px 6px 12px rgba(0, 0, 0, 0.25);
  display: none;
  z-index: 1000;
  border: 1px solid #555; /* Borda suave */
}

.tutorial-balao::after {
  content: "";
  position: absolute;
  bottom: -10px;
  left: 20px;
  width: 0;
  height: 0;
  border-left: 10px solid transparent;
  border-right: 10px solid transparent;
  border-top: 10px solid #333;
}

.tutorial-balao .botao {
  display: flex;
  justify-content: space-between;
  margin-top: 15px;
}

.fechar-tutorial {
  position: absolute;
  top: 2px;
  right: 2px;
  background-color: transparent;
  border: none;
  color: #ff5e5e; /* Vermelho suave */
  font-size: 15px;
  cursor: pointer;
  transition: transform 0.2s ease, color 0.2s ease; /* Efeito de transição */
}

.fechar-tutorial:hover {
  color: #ff3838; /* Muda o tom ao passar o mouse */
  transform: scale(1.2); /* Leve aumento ao passar o mouse */
}

.fechar-tutorial:focus {
  outline: none; /* Remove a borda de foco padrão */
}
    </style>
</head>
<body>

    <header>
        <div class="operating-hours">
    <span id="status" class="status">Fechado</span>
</div>
    <img src="https://goscript.neocities.org/imagens.png/compressed_logo.png" alt="Logo" class="logo">
    </header>
    
<!-- Barra de categorias -->
<div class="category-menu">
    <div tabindex="-1" onclick="scrollToCategory('pizzas')">Pizzas</div>
    <div tabindex="-1" onclick="scrollToCategory('esfihas')">Esfihas</div>
    <div tabindex="-1" onclick="scrollToCategory('bebidas')">Bebidas</div>
    <div tabindex="-1" onclick="scrollToCategory('refrigerantes')">Refrigerantes</div>
    <div tabindex="-1" onclick="scrollToCategory('combos')">Combos</div>
</div>
    
    <!-- Balões de tutorial -->
<div id="tutorial1" class="tutorial-balao" style="top: 255px; left: 150px;">
  Bem-vindo! Clique em alguma categoria para escolher um item.
  <button class="fechar-tutorial" onclick="fecharTutorial()">X</button>
  <div class="botao">
    <button onclick="proximoTutorial(1)">Próximo</button>
  </div>
</div>
<div id="tutorial2" class="tutorial-balao" style="top: 655px; left: 150px; z-index: 3000;">
  Aqui você pode ver os itens que tem no seu carrinho.
  <button class="fechar-tutorial" onclick="fecharTutorial()">X</button>
  <div class="botao">
    <button onclick="anteriorTutorial(2)">Voltar</button>
    <button onclick="proximoTutorial(2)">Próximo</button>
  </div>
</div>
<div id="tutorial3" class="tutorial-balao" style="top: 595px; left: 130px; z-index: 3000;">
  Finalize o pedido clicando aqui após escolher.
  <button class="fechar-tutorial" onclick="fecharTutorial()">X</button>
  <div class="botao">
    <button onclick="anteriorTutorial(3)">Voltar</button>
    <button onclick="fecharTutorial()">Concluir</button>
  </div>
</div>

    <!-- Lista de produtos por categoria -->
    <div class="product-list" id="pizzas" onclick="openCategory('pizzas')">
    <h2>Pizzas</h2>
    <div class="product">
        <span class="product-title">Pizzas ></span></span> </span>
        <span class="price">A partir de R$ 25,00</span>
        <div class="note">Não permitido adicionais</div>
    </div>
</div>

    <div class="product-list" id="esfihas" onclick="openCategory('esfirras')">
    <h2>Esfihas</h2>
    <div class="product">
        <span class="product-title">Esfihas Salgadas ></span></span>
        <span class="price">A partir de R$ 2,50</span>
        <div class="note">Não permitido adicionais</div>
    </div>
</div>

<div class="product-list" id="bebidas" onclick="openCategory('bebidas')">
    <h2>Bebidas</h2>
    <div class="product">
        <span class="product-title">Bebidas ></span></span>
        <span class="price">A partir de R$ 3,00</span>
        <div class="note">Não permitido adicionais</div>
    </div>
</div>
    
    <div id="category-container" class="category-content">
    <button class="back-btn" onclick="closeCategory()">←</button>
    <h2 id="category-title">Categoria</h2>

    <!-- Exibir o Total aqui dentro -->
    <div class="total-display">
        Total: <span id="total-value-top">R$ 0,00</span>
    </div>

    <div id="category-products"></div>
</div>

    <div class="cart-toggle" onclick="toggleCart()">
    Carrinho
    <div class="notification-bubble" id="cart-notification">0</div> <!-- Balão de notificação -->
</div>

    <div class="cart" id="cart">
        <div class="cart-header">
            <h2>Produtos Escolhidos</h2>
            <button class="close-cart" onclick="toggleCart()">X</button>
        </div>
        <ul class="cart-items"></ul>
        <div class="cart-total">
            <span>Total sem a taxa de entrega incluída:</span>
            <span id="total-value">R$ 0,00</span>
        </div>
        <button id="finalize-order">Finalizar Pedido</button>
    </div>

    <div class="checkout" id="checkout">
    <div class="checkout-header">
        <button class="back-btn" onclick="toggleCheckout()">←</button>
        <h2>Dados do Cliente</h2>
    </div>
    <div class="form-field">
    <label for="service-type">Tipo de serviço:</label>
    <select id="service-type" onchange="toggleDeliveryFields()">
        <option value="selecionar">Selecione</option> <!-- Opção padrão -->
        <option value="delivery">Delivery</option>
        <option value="retirar">Retirar no local</option>
    </select>
</div>

<div class="form-field" id="location-option" style="display: none;">
    <label>Você está no local de entrega agora?</label>
    <div class="inline-options">
        <input type="radio" id="location-now" name="location" value="sim">
        <label for="location-now">Sim</label>
        <input type="radio" id="location-no" name="location" value="nao">
        <label for="location-no">Não</label>
    </div>
</div>

<!-- Botão de Localização -->
<div id="location-button" class="form-field" style="display: none;">
    <button id="open-maps" onclick="openMaps()">Ver Localização no Google Maps</button>
</div>
    <div class="form-field">
        <label for="name">Nome:</label>
        <input type="text" id="name" placeholder="Seu nome">
    </div>
    <div class="form-field">
    <label for="cep">CEP (Opcional):</label>
    <input type="text" id="cep" class="delivery-field" placeholder="CEP" onblur="buscarCEP()">
</div>
<div class="form-field">
    <label for="rua">Rua:</label>
    <input type="text" id="rua" class="delivery-field" placeholder="Sua rua">
</div>
<div class="form-field">
    <label for="bairro">Bairro:</label>
    <input type="text" id="bairro" class="delivery-field" placeholder="Seu bairro">
</div>
<div class="form-field">
    <label for="cidade">Cidade:</label>
    <input type="text" id="cidade" class="delivery-field" placeholder="Sua cidade">
</div>
<div class="form-field">
    <label for="ponto_referencia">Ponto de Referência:</label>
    <input type="text" id="ponto_referencia" class="delivery-field" placeholder="Ponto de referência">
</div>

    <!-- Formas de pagamento -->
    <div class="form-field">
        <label for="payment-method">Forma de pagamento:</label>
        <select id="payment-method" onchange="toggleChangeField()">
            <option value="pix">Pix</option>
            <option value="cartao">Cartão de Crédito (Maquininha)</option>
            <option value="dinheiro">Dinheiro</option>
        </select>
    </div>

    <!-- Campo de troco (apenas para pagamento em dinheiro) -->
    <div id="change-field" class="form-field" style="display: none;">
        <label for="change-for">Troco para:</label>
        <input type="number" id="change-for" placeholder="Digite o valor para o troco">
    </div>

    <button id="submit-order">Enviar Pedido</button>
</div>

    <script>
        let cart = [];
let total = 0;
let totalItems = 0; // Contador de itens no carrinho

// Coordenadas do estabelecimento
const estabelecimentoLat = -22.331317; // Exemplo de latitude (Mogi Guaçu)
const estabelecimentoLng = -46.923289; // Exemplo de longitude (São Paulo)

// Função para calcular distância usando o método Haversine
function calcularDistancia(lat1, lng1, lat2, lng2) {
    const R = 6371; // Raio da Terra em km
    const dLat = (lat2 - lat1) * (Math.PI / 180);
    const dLng = (lng2 - lng1) * (Math.PI / 180);
    const a = 
        Math.sin(dLat / 2) * Math.sin(dLat / 2) +
        Math.cos(lat1 * (Math.PI / 180)) * Math.cos(lat2 * (Math.PI / 180)) * 
        Math.sin(dLng / 2) * Math.sin(dLng / 2);
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    return R * c; // Distância em km
}

// Função para calcular a distância e exibir a taxa de entrega
function calcularFrete() {
    const serviceType = document.getElementById('service-type').value;

    if (serviceType !== 'delivery') {
        return;
    }

    navigator.geolocation.getCurrentPosition((position) => {
        const clienteLat = position.coords.latitude;
        const clienteLng = position.coords.longitude;
        const distancia = calcularDistancia(estabelecimentoLat, estabelecimentoLng, clienteLat, clienteLng);
        let valorEntrega = distancia * 2; // Considerando R$ 2,00 por km

        // Arredonda o valor da entrega conforme solicitado
        if (valorEntrega % 1 >= 0.5) {
            valorEntrega = Math.ceil(valorEntrega); // Arredonda para cima
        } else {
            valorEntrega = Math.floor(valorEntrega); // Arredonda para baixo
        }

        // Exibe o valor da entrega arredondado
        alert(`A taxa de entrega é de R$ ${valorEntrega.toFixed(2).replace('.', ',')}`);
        
        // Atualiza o total no carrinho
        document.getElementById('total-value').innerText = `R$ ${(total + valorEntrega).toFixed(2).replace('.', ',')}`;
        document.getElementById('total-value-top').innerText = `R$ ${(total + valorEntrega).toFixed(2).replace('.', ',')}`;

        // Chama a função para enviar o pedido via WhatsApp com o valor do frete
        enviarPedidoWhatsApp(valorEntrega);
    }, (error) => {
        alert("Não foi possível obter a localização.");
    });
}

// Modifique o evento do botão de envio do pedido para chamar apenas `enviarPedidoWhatsApp` diretamente
document.getElementById('submit-order').addEventListener('click', () => {
    const serviceType = document.getElementById('service-type').value;

    if (serviceType === 'delivery') {
        calcularFrete(); // Calcula o frete se o serviço for "delivery"
    } else {
        enviarPedidoWhatsApp(0); // Envia o pedido diretamente sem o valor do frete se for "retirar no local"
    }
});

document.addEventListener("DOMContentLoaded", function() {
  mostrarTutorial(1); // Mostra o primeiro balão ao carregar
});

function mostrarTutorial(id) {
  document.getElementById(`tutorial${id}`).style.display = 'block';
}

function esconderTutorial(id) {
  document.getElementById(`tutorial${id}`).style.display = 'none';
}

function proximoTutorial(id) {
  esconderTutorial(id);

  if (id === 2) {
    // Abre o carrinho e mostra o tutorial 3 imediatamente
    const cartElement = document.getElementById('cart');
    cartElement.classList.add('open');
    mostrarTutorial(3);
  } else {
    mostrarTutorial(id + 1);
  }
}

function anteriorTutorial(id) {
  esconderTutorial(id);
  mostrarTutorial(id - 1);
}

function fecharTutorial() {
  for (let i = 1; i <= 3; i++) {
    esconderTutorial(i);
  }
}

// Função para enviar o pedido pelo WhatsApp com o valor da entrega incluído
function enviarPedidoWhatsApp(valorEntrega) {
    const name = document.getElementById('name').value;
    const serviceType = document.getElementById('service-type').value;
    const cep = document.getElementById('cep').value;
    const rua = document.getElementById('rua').value;
    const bairro = document.getElementById('bairro').value;
    const cidade = document.getElementById('cidade').value;
    const pontoReferencia = document.getElementById('ponto_referencia').value;
    const paymentMethod = document.getElementById('payment-method').value;
    const changeFor = document.getElementById('change-for').value; // Valor do troco

    // Verificação de campos obrigatórios
    if (name === '') {
        alert('Por favor, preencha o nome!');
        return;
    }

    if (serviceType === 'delivery') {
        if (rua === '' || bairro === '' || cidade === '') {
            alert('Por favor, preencha todos os campos obrigatórios de entrega!');
            return;
        }
    }

    // Construção da mensagem com o valor de entrega incluído
    let message = `Pedido:\n`;
    cart.forEach(item => {
        message += `${item.name} - R$ ${item.price.toFixed(2).replace('.', ',')} (Qtd: ${item.quantity})\n`;
    });
    message += `\nTotal (incluindo entrega): R$ ${(total + valorEntrega).toFixed(2).replace('.', ',')}\n`;
    message += `\nNome: ${name}\n`;

    if (serviceType === 'delivery') {
        message += `CEP: ${cep}\nRua: ${rua}\nBairro: ${bairro}\nCidade: ${cidade}\nPonto de Referência: ${pontoReferencia}\n`;
    } else {
        message += `Retirar no local.\n`;
    }

    // Adiciona a forma de pagamento
    message += `\nForma de Pagamento: ${paymentMethod.charAt(0).toUpperCase() + paymentMethod.slice(1)}`;

    // Se a forma de pagamento for "Dinheiro", adiciona o valor do troco
    if (paymentMethod === 'dinheiro' && changeFor !== '') {
        message += `\nTroco para: R$ ${parseFloat(changeFor).toFixed(2).replace('.', ',')}`;
    }

    const whatsappUrl = `https://wa.me/5519998133764?text=${encodeURIComponent(message)}`;
    window.open(whatsappUrl, '_blank');

    // Limpar o carrinho após o envio
    cart = [];
    totalItems = 0;
    total = 0;

    // Atualizar a exibição do carrinho
    renderCart();
    updateCartNotification();
    
    // Fechar o checkout após o envio do pedido
    document.getElementById('checkout').classList.remove('open');
}

// Modifique o evento do botão para incluir o cálculo do frete
document.getElementById('submit-order').addEventListener('click', () => {
    calcularFrete();
});

// Função para rolar até a categoria
function scrollToCategory(categoryId) {
    document.getElementById(categoryId).scrollIntoView({ behavior: 'smooth' });
}

// Função para atualizar a quantidade de produtos no carrinho
function updateQuantity(index, category, change) {
    const product = products[category][index];
    const quantityElement = document.getElementById(`quantity-${category}-${index}`);
    let quantity = parseInt(quantityElement.innerText);

    // Atualiza a quantidade
    quantity += change;
    if (quantity < 0) {
        quantity = 0;
    }
    
    quantityElement.innerText = quantity;

    // Atualiza o carrinho
    updateCart(product, quantity);
}

// Função para adicionar/remover do carrinho
function updateCart(product, quantity) {
    const cartItemIndex = cart.findIndex(item => item.name === product.name);

    if (quantity === 0) {
        // Remove o item se a quantidade for 0
        if (cartItemIndex !== -1) {
            totalItems -= cart[cartItemIndex].quantity; // Diminui o total de itens
            cart.splice(cartItemIndex, 1);
        }
    } else {
        if (cartItemIndex !== -1) {
            // Atualiza a quantidade do item no carrinho
            totalItems += quantity - cart[cartItemIndex].quantity; // Ajusta o total de itens
            cart[cartItemIndex].quantity = quantity;
        } else {
            // Adiciona o item ao carrinho
            cart.push({ ...product, quantity });
            totalItems += quantity; // Incrementa o total de itens
        }
    }

    renderCart();
    updateCartNotification(); // Atualiza o balão de notificação
}

// Função para renderizar o carrinho
function renderCart() {
    const cartItems = document.querySelector('.cart-items');
    cartItems.innerHTML = '';
    total = 0;

    cart.forEach(item => {
        const li = document.createElement('li');
        li.classList.add('cart-item');
        li.innerHTML = `
            ${item.name} - R$ ${(item.price * item.quantity).toFixed(2).replace('.', ',')} (Qtd: ${item.quantity})
            <button class="remove-btn" onclick="removeItem('${item.name}')">X</button>
        `;
        cartItems.appendChild(li);

        // Calcula o total
        total += item.price * item.quantity;
    });

    document.getElementById('total-value').innerText = `R$ ${total.toFixed(2).replace('.', ',')}`;
    document.getElementById('total-value-top').innerText = `R$ ${total.toFixed(2).replace('.', ',')}`;
}

// Função para remover itens do carrinho ao clicar no botão "Remover"
function removeCartItem(index) {
    cart.splice(index, 1);  // Remove o item do array do carrinho
    renderCart();  // Atualiza a exibição do carrinho
}

// Função para atualizar o balão de notificação
function updateCartNotification() {
    const notification = document.getElementById('cart-notification');
    
    if (totalItems > 0) {
        notification.style.display = 'block';
        notification.innerText = totalItems;
    } else {
        notification.style.display = 'none'; // Esconde o balão se não houver itens
    }
}

// Função para abrir e fechar a tela de checkout
// Adiciona um estado ao histórico ao abrir o checkout
function toggleCheckout() {
    const cartElement = document.getElementById('cart');
    const checkoutElement = document.getElementById('checkout');
    
    if (cartElement.classList.contains('open')) {
        cartElement.classList.remove('open'); // Fecha o carrinho
        checkoutElement.classList.add('open'); // Abre o checkout
        history.pushState({ page: 'checkout' }, '', '#checkout'); // Adiciona estado no histórico
    } else {
        // Alterna entre o estado aberto e fechado do checkout
        checkoutElement.classList.toggle('open');
        if (checkoutElement.classList.contains('open')) {
            history.pushState({ page: 'checkout' }, '', '#checkout');
        } else {
            history.back(); // Volta para o estado anterior no histórico
        }
    }
}

// Fecha o checkout ao pressionar o botão "voltar" do celular
window.addEventListener('popstate', function(event) {
    const checkoutElement = document.getElementById('checkout');
    if (checkoutElement.classList.contains('open')) {
        checkoutElement.classList.remove('open');
        event.preventDefault(); // Previne o comportamento padrão
    }
});

// Finalizar o pedido e abrir a tela de checkout
document.getElementById('finalize-order').addEventListener('click', () => {
    toggleCheckout();
});

// Função para abrir e fechar o carrinho
function toggleCart() {
  const cartElement = document.getElementById('cart');
  const checkoutElement = document.getElementById('checkout');
  
  // Se o checkout estiver aberto, fecha-o antes de abrir o carrinho
  if (checkoutElement.classList.contains('open')) {
      checkoutElement.classList.remove('open');
  }

  // Alterna a exibição do carrinho sem afetar o tutorial
  cartElement.classList.toggle('open');
}

// Função para exibir o campo de troco se a forma de pagamento for "Dinheiro"
function toggleChangeField() {
    const paymentMethod = document.getElementById('payment-method').value;
    const changeField = document.getElementById('change-field');
    if (paymentMethod === 'dinheiro') {
        changeField.style.display = 'block';
    } else {
        changeField.style.display = 'none';
    }
}

// Função para exibir/ocultar os campos de entrega
function toggleDeliveryFields() {
    const serviceType = document.getElementById('service-type').value;
    const deliveryFields = document.querySelectorAll('.delivery-field');
    const locationOption = document.getElementById('location-option');

    if (serviceType === 'delivery') {
        deliveryFields.forEach(field => {
            field.disabled = false;
            field.style.backgroundColor = ''; // Remove a cor de desativado
        });
        locationOption.style.display = 'block'; // Exibe as opções "Sim" e "Não"
    } else {
        deliveryFields.forEach(field => {
            field.disabled = true;
            field.style.backgroundColor = '#e9e9e9'; // Ajusta a cor para parecer desativado
        });
        locationOption.style.display = 'none'; // Oculta as opções "Sim" e "Não"
    }
}

document.getElementById('location-now').addEventListener('change', () => {
    const serviceType = document.getElementById('service-type').value;
    const locationNow = document.getElementById('location-now').checked;

    if (serviceType === 'delivery' && locationNow) {
        calcularFrete(); // Calcula o frete automaticamente ao selecionar "Sim"
    }
});

// Função para abrir o Google Maps com a localização do estabelecimento
// Função para abrir o Google Maps com a URL fornecida
function openMaps() {
    const url = `https://maps.app.goo.gl/3216hTmpqQ7a2Qgh6`; // URL do lugar específico no Google Maps
    window.open(url, '_blank');
}

// Função para enviar o pedido pelo WhatsApp com o valor da entrega incluído
function enviarPedidoWhatsApp(valorEntrega) {
    const name = document.getElementById('name').value;
    const serviceType = document.getElementById('service-type').value;
    const cep = document.getElementById('cep').value;
    const rua = document.getElementById('rua').value;
    const bairro = document.getElementById('bairro').value;
    const cidade = document.getElementById('cidade').value;
    const pontoReferencia = document.getElementById('ponto_referencia').value;
    const paymentMethod = document.getElementById('payment-method').value;
    const changeFor = document.getElementById('change-for').value; // Valor do troco

    // Verificação de campos obrigatórios
    if (name === '') {
        alert('Por favor, preencha o nome!');
        return;
    }

    if (serviceType === 'delivery') {
        if (rua === '' || bairro === '' || cidade === '') {
            alert('Por favor, preencha todos os campos obrigatórios de entrega!');
            return;
        }
    }

    // Construção da mensagem com o valor de entrega incluído
    let message = `*Pedido:* \n`;
    cart.forEach(item => {
        message += `${item.name} - R$ ${item.price.toFixed(2).replace('.', ',')} (Qtd: ${item.quantity})\n`;
    });
    message += `\n *Total:* R$ ${(total + valorEntrega).toFixed(2).replace('.', ',')}\n`;

    // Adiciona a taxa de entrega quando for delivery
    if (serviceType === 'delivery') {
        message += `Taxa de entrega: R$ ${valorEntrega.toFixed(2).replace('.', ',')} (já adicionada ao total)\n`;
    }

message += `\n===========================`;

message += `\n *Dados da entrega:*`;
    message += `\nNome: ${name}\n`;

    if (serviceType === 'delivery') {
        message += `CEP: ${cep}\nRua: ${rua}\nBairro: ${bairro}\nCidade: ${cidade}\nPonto de Referência: ${pontoReferencia}\n`;
    } else {
        message += `_Retirar no local._\n`;
    }
    
    message += `\n===========================`;

    // Adiciona a forma de pagamento
    message += `\n *Forma de Pagamento:* ${paymentMethod.charAt(0).toUpperCase() + paymentMethod.slice(1)}`;

    // Se a forma de pagamento for "Dinheiro", adiciona o valor do troco
    if (paymentMethod === 'dinheiro' && changeFor !== '') {
        message += `\nTroco para: R$ ${parseFloat(changeFor).toFixed(2).replace('.', ',')}`;
    }

    const whatsappUrl = `https://wa.me/5519988283178?text=${encodeURIComponent(message)}`;
    window.open(whatsappUrl, '_blank');

    // Limpar o carrinho após o envio
    cart = [];
    totalItems = 0;
    total = 0;

    // Atualizar a exibição do carrinho
    renderCart();
    updateCartNotification();
    
    // Fechar o checkout após o envio do pedido
    document.getElementById('checkout').classList.remove('open');
}

// Modifique o evento do botão para incluir o cálculo do frete
document.getElementById('finalize-order').addEventListener('click', () => {
    calcularFrete();
});

// Função para buscar o endereço pelo CEP via API
function buscarCEP() {
    const cep = document.getElementById('cep').value.replace(/\D/g, '');

    if (cep !== "") {
        const validacep = /^[0-9]{8}$/;

        if (validacep.test(cep)) {
            fetch(`https://viacep.com.br/ws/${cep}/json/`)
                .then(response => response.json())
                .then(data => {
                    if (!("erro" in data)) {
                        document.getElementById('rua').value = data.logradouro;
                        document.getElementById('bairro').value = data.bairro;
                        document.getElementById('cidade').value = data.localidade;
                    } else {
                        alert("CEP não encontrado.");
                    }
                })
                .catch(error => {
                    console.error("Erro ao buscar o CEP: ", error);
                    alert("Erro ao buscar o CEP.");
                });
        } else {
            alert("Formato de CEP inválido.");
        }
    }
}

// Exemplo de produtos por categoria
const products = {
    esfirras: [
        { name: 'Esfiha Carne', price: 2.50 },
        { name: 'Esfiha Mussarela', price: 4.00 }, 
        { name: 'Esfiha Costela', price: 5.50 }
    ],
    pizzas: [
        { name: 'Pizza Margherita', price: 25.00 },
        { name: 'Pizza Calabresa', price: 27.00 },
        { name: 'Pizza Portuguêsa', price: 35.00 }
    ], 
    bebidas: [
        { name: 'Suco de uva', price: 3.00 },
        { name: 'Suco de laranja', price: 4.00 }
    ]
};

// Função para abrir o container de categoria e exibir os produtos com botões de + e -
function openCategory(category) {
    const categoryTitle = document.getElementById('category-title');
    const categoryProducts = document.getElementById('category-products');
    
    // Define o título da categoria
    categoryTitle.innerText = category.charAt(0).toUpperCase() + category.slice(1);
    
    // Limpa os produtos anteriores
    categoryProducts.innerHTML = '';

    // Insere os produtos da categoria selecionada
    products[category].forEach((product, index) => {
        const productElement = document.createElement('div');
        productElement.classList.add('product');
        productElement.innerHTML = `
            <span class="product-title">${product.name}</span>
            <span class="price">R$ ${product.price.toFixed(2).replace('.', ',')}</span>
            <button class="remove-btn" onclick="updateQuantity(${index}, '${category}', -1)">-</button>
            <span id="quantity-${category}-${index}">0</span>
            <button class="add-btn" onclick="updateQuantity(${index}, '${category}', 1)">+</button>
        `;
        categoryProducts.appendChild(productElement);
    });

    // Exibe o container de categoria
    document.getElementById('category-container').classList.add('active');

    // Adiciona estado ao histórico para permitir o botão "voltar"
    history.pushState({ page: 'category' }, '', '#category');
}

// Função para fechar o container de categoria
function closeCategory() {
    document.getElementById('category-container').classList.remove('active');
}

// Evento para fechar o container de categoria ao pressionar "voltar"
window.addEventListener('popstate', function(event) {
    const categoryContainer = document.getElementById('category-container');
    if (categoryContainer.classList.contains('active')) {
        closeCategory();
    }
});

// Função para remover itens do carrinho
function removeItem(productName) {
    const cartItemIndex = cart.findIndex(item => item.name === productName);

    if (cartItemIndex !== -1) {
        totalItems -= cart[cartItemIndex].quantity; // Diminui a quantidade total de itens no carrinho
        cart.splice(cartItemIndex, 1); // Remove o item do array do carrinho
    }

    renderCart(); // Atualiza a exibição do carrinho
    updateCartNotification(); // Atualiza o balão de notificação
}

function checkIfOpen() {
    const now = new Date();
    const dayOfWeek = now.getDay(); // 0 = Domingo, 6 = Sábado
    const hour = now.getHours();
    const minute = now.getMinutes();

    const openingHour = 18; // Horário de abertura
    const closingHour = 0; // Horário de fechamento (meia-noite)

    let isOpen = false;

    // Verifica se está entre segunda e sábado
    if (dayOfWeek >= 1 && dayOfWeek <= 6) {
        // Verifica se a loja está aberta hoje
        if (hour >= openingHour || (hour === closingHour && minute === 0)) {
            isOpen = true;
        }
    }

    const statusElement = document.getElementById('status');

    if (isOpen && !(hour === closingHour && minute > 0)) {
        // Loja está aberta e ainda não passou da meia-noite
        statusElement.innerText = `Loja aberta, fecha às 00h`;
        statusElement.classList.add('open');
        statusElement.classList.remove('closed');
    } else {
        // Loja está fechada
        if (hour < openingHour && dayOfWeek >= 1 && dayOfWeek <= 6) {
            // Se a loja ainda não abriu hoje
            statusElement.innerText = `Loja fechada, abre às ${openingHour}:00h`;
        } else {
            // Se a loja já fechou ou está fechada no dia atual
            statusElement.innerText = `Loja fechada, abre amanhã às ${openingHour}:00h`;
        }
        statusElement.classList.add('closed');
        statusElement.classList.remove('open');
    }
}

// Verifica o status assim que a página carrega
window.onload = checkIfOpen;
    </script>
</body>
</html>